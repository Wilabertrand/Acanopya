<div class="container py-4">
  <%= link_to "retour", trip_flats_path(@trip) %>
	<h1><%= @flat.name %></h1>
	<p><%= @flat.address %></p>

  <div class="row">
    <div class="col-md-6">
      <%= image_tag 'photo.jpg', class:"w-100 h-100" %>
    </div>
    <div class="col-md-6">
      <div class="row row-cols-2 flex-wrap">
        <div class="col-md-6 p-1"><%= image_tag 'photo.jpg', class:"w-100 h-100" %></div>
        <div class="col-md-6 p-1"><%= image_tag 'photo.jpg', class:"w-100 h-100" %></div>
        <div class="col-md-6 p-1"><%= image_tag 'photo.jpg', class:"w-100 h-100" %></div>
        <div class="col-md-6 p-1"><%= image_tag 'photo.jpg', class:"w-100 h-100" %></div>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col-md-8">
      <!-- Flat card -->
      <div class="d-flex pt-4 pb-4 border-bottom">
        <div><%= image_tag "https://konsultan.online/wp-content/uploads/avatar-7.png", class: "avatar dropdown-toggle", id: "navbarDropdown", data: { toggle: "dropdown" }, 'aria-haspopup': true, 'aria-expanded': false %></div>
        <div class="pl-2"><p>Proposé par <%#= @flat.user.email.split("@").first %></p></div>
      </div>
      <div class="pt-4 pb-4 border-bottom">
        <p><%= @flat.description %></p>
        <%#= link_to "Retour aux hébergements", flats_path, class:"btn btn-secondary" %>
      </div>
    </div>
    <div class="col-md-4">
      <!-- Booking card -->
      <div id="form_booking">
        <div class="d-flex justify-content-between mt-2">
          <div class="important">
            <p><%= @flat.price %><span style="font-size: 16px">0€</span></p>
          </div>
        </div>
        <p>Pour <%= @flat.capacity %>personnes </p>
        <div>
          <%= simple_form_for [@flat, @booking_flat], url: flat_flats_bookings_path(@flat) do |f| %>
              <%= f.input :trip_id, as: :hidden, input_html:{value:@trip.id} %>
              <%= f.input :start_date, :as => :date, :order => [:day, :month, :year] %> 
              <%= f.input :end_date, :as => :date, :order => [:day, :month, :year] %> 
            <%= f.button :submit, "Réserver", class: "btn btn-primary w-100" %>
          <% end %>
        </div>
        <div class="d-flex justify-content-between mt-3 border-bottom">
        </div>

        <div class="important">
          <div class="d-flex justify-content-between mt-3">
            <p><strong>Total</strong></p>
            <p><strong>200€</strong></p>
          </div>
        </div>
      </div>
    </div>
  </div>

  
  <div class="pb-2"><h3>Emplacement</h3>
    <div id="map"
      style="width: 100%; height: 600px; border-radius: 10px;"
      data-markers="<%= @markers.to_json %>"
      data-mapbox-api-key="<%= ENV['MAPBOX_API_KEY'] %>">
    </div>
  </div>
</div>


<div class="row">
    <div class="gallery">
      <div class="img">
        <%= image_tag 'photo.jpg', class:"w-100" %>
      </div>
      <div class="img">
        <%= image_tag 'photo.jpg', class:"w-100" %>
      </div>
      <div class="img">
        <%= image_tag 'photo.jpg', class:"w-100" %>
      </div>
      <div class="img">
        <%= image_tag 'photo.jpg', class:"w-100" %>
      </div>
      <div class="img">
        <%= image_tag 'photo.jpg', class:"w-100" %>
      </div>
    </div>
  </div>

<p>Moyenne : <%#= @average_rating %></</p>
  <%# if @booking.display_review_form(current_user) %>
    <div class="reviews">
    <h2>Voir les évaluations</h2>
      <% @flat_reviews.each do |flat_review| %>
        <p>
          <%= flat_review.user.first_name %>
          <% flat_review.rating.times do %>
            <i class="fas fa-star"></i>
          <% end %>
          <% (5 - flat_review.rating).times do %>
            <i class="far fa-star"></i>
          <% end %>
        </p>
        <p><%= flat_review.content %></p>
      <% end %>
    </div>
  <%# end %>
  <% if @flatreservation %>
  <div class="review">
    <h2>Laissez une évaluation</h2>
    <%= simple_form_for @flat_review, url: flats_booking_flat_reviews_path(@flatreservation) do |f| %>
      <%= f.input :content %>
      <%= f.input :rating, collection: (1..5).to_a, label: "notez votre expérience" %>
      <div class="my-3">
        <% 5.times do |index| %>
          <i id="<%= index + 1 %>" class="review-rating far fa-star"></i>
        <% end %>
      </div>
      <%= f.submit class: "btn btn-primary", value: "Valider" %>
    <% end %>
  <% end %>
  </div>
