<div class="container py-4">
    <h1>Tous Mes voyages</h1>
    <br>
    <br>
    <ul>
        <% @trips.each do |trip| %>
        <div class="trip-box">
            <div class="voyage-box">
                <div class="voyage">
                    <div>
                    <span><%= link_to trip.name, trip_path(trip) %></span>
                    <span>, voyage du <%= trip.start_date %> au <%= trip.end_date %></span>
                    </div>
                    <div>
                    <% if policy(trip).show? %>
                        <span><%= link_to "Voir", trip_path(trip) %></span>
                    <% end %>
                    </div>
                    <div>
                    <% if policy(trip).destroy? %>
                        <span><%= link_to "Supprimer",
                            trip_path(trip),
                            method: :delete,
                            data: { confirm: "Êtes-vous sûr?" } %></span>
                    <% end %>
                    </div>
                </div>
                <br>
                <p>Mes réservations d'hébergements</p>
                <% trip.booking_flats.each do |booking_flat| %> 
                <div class="reservation-box">
                    <div class="cards-sumup">
                        <%= cl_image_tag booking_flat.flat.photos.first.key, class:'card-booking-img-sumup' %>
                        <div class="card-booking-infos-sumup">
                            <p><%= link_to booking_flat.flat.name, trip_flat_path(trip, booking_flat.flat) %></p>
                            <p>Réservé du : <%= booking_flat.start_date %> au <%= booking_flat.end_date %></p> 
                            <p>Pour un montant de : <%= booking_flat.flat.price %>0€ / nuité / personne </p>
                            <p>Statut de votre réservation : <%= booking_flat.status %></p>
                            <p><%# if !booking_flat.flat_review.present? %>
                                <%= link_to "Noter l'hébergement", trip_flat_path(trip, booking_flat.flat) %></p>
                            <%# end %></p>
                        </div>
                    </div>
                </div>
                <% end %>
                <p>Mes réservations de restaurants</p>
                <% trip.booking_restaurants.each do |booking_restaurant| %> 
                <div class="reservation-box">
                    <div class="cards-sumup">
                        <%= cl_image_tag booking_restaurant.restaurant.photos.first.key, class:'card-booking-img-sumup' %>
                        <div class="card-booking-infos-sumup">
                            <p><%= link_to booking_restaurant.restaurant.name, trip_restaurant_path(trip, booking_restaurant.restaurant) %></p>
                            <p>Réservé le : <%= booking_restaurant.start_date %>
                            <p>Pour un montant de : <%= booking_restaurant.restaurant.price %>0€ /menu / personne</p>
                            <p>Statut de votre réservation : <%= booking_restaurant.status %></p>
                            <p><%= link_to "Noter le restaurant", trip_restaurant_path(trip, booking_restaurant.restaurant) %></p>
                        </div>
                    </div>
                </div>
                <% end %>
                <p>Mes réservations d'activités</p>
                <% trip.booking_activities.each do |booking_activity| %> 
                <div class="reservation-box">
                    <div class="cards-sumup">
                        <%= cl_image_tag booking_activity.activity.photos.first.key, class:'card-booking-img-sumup' %>
                        <div class="card-booking-infos-sumup">
                            <p><%= link_to booking_activity.activity.name, trip_activity_path(trip, booking_activity.activity) %></p>
                            <p>Réservé le : <%= booking_activity.start_date %></p> 
                            <p>Pour un montant de : <%= booking_activity.activity.price %>0€ / personne</p>
                            <p>Statut de votre réservation : <%= booking_activity.status %></p>
                            <p><%= link_to "Noter l'activité", trip_activity_path(trip, booking_activity.activity) %></p>
                        </div>
                    </div>
                </div>
                <% end %>
                <p>Calculez votre emprunte carbone</p>
            </div>
        </div>
        <% end %>
    </ul>
</div>
